<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/" />
    </ion-buttons>
    <ion-title>Hotels</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="console-page">
    <section class="console-hero">
      <div>
        <p class="console-eyebrow">Portfolio Management</p>
        <h1>Hotels</h1>
        <p>
          Organize hotels under the right group, define property codes, and keep location data clean
          for staff and guest-facing flows.
        </p>
      </div>
      <div class="console-meta">
        <span class="console-pill">{{ items().length }} hotel(s)</span>
        <span class="console-pill">{{ hotelGroups().length }} group option(s)</span>
      </div>
    </section>

    <div class="console-grid">
      <ion-card class="console-card">
        <ion-card-header>
          <ion-card-title>{{ form.id ? 'Edit Hotel' : 'Create Hotel' }}</ion-card-title>
          <p class="section-copy">
            Each hotel inherits its broader admin scope from a hotel group.
          </p>
        </ion-card-header>
        <ion-card-content>
          <form class="console-form" (ngSubmit)="save()">
            <div class="form-grid">
              <ion-item class="field-item">
                <ion-label position="stacked">Name</ion-label>
                <ion-input [(ngModel)]="form.name" name="name" required />
              </ion-item>
              <ion-item class="field-item">
                <ion-label position="stacked">Code</ion-label>
                <ion-input [(ngModel)]="form.code" name="code" />
              </ion-item>
              <ion-item class="field-item">
                <ion-label position="stacked">City</ion-label>
                <ion-input [(ngModel)]="form.city" name="city" />
              </ion-item>
              <ion-item class="field-item">
                <ion-label position="stacked">Country</ion-label>
                <ion-input [(ngModel)]="form.country" name="country" />
              </ion-item>
              @if (showHotelGroupSelector()) {
                <ion-item class="field-item span-2">
                  <ion-label position="stacked">Hotel Group</ion-label>
                  <ion-select [(ngModel)]="form.hotelGroupId" name="hotelGroupId" interface="alert" required>
                    <ion-select-option [value]="null">Select a group</ion-select-option>
                    @for (group of hotelGroups(); track group.id ?? group.name) {
                      <ion-select-option [value]="group.id ?? null">
                        {{ group.name }}{{ group.code ? ' (' + group.code + ')' : '' }}
                      </ion-select-option>
                    }
                  </ion-select>
                </ion-item>
              } @else {
                <ion-item class="field-item span-2">
                  <ion-label position="stacked">Hotel Group</ion-label>
                  <ion-input [value]="fixedHotelGroupName()" readonly />
                </ion-item>
              }
            </div>

            <div class="form-actions">
              <ion-button type="submit" [disabled]="saving()">
                {{ saving() ? 'Saving...' : form.id ? 'Update' : 'Create' }}
              </ion-button>
              <ion-button type="button" fill="outline" (click)="resetForm()">Reset</ion-button>
              <ion-button type="button" fill="clear" (click)="refreshAll()">Refresh</ion-button>
            </div>
          </form>
          @if (error()) {
            <p class="error-text">{{ error() }}</p>
          }
        </ion-card-content>
      </ion-card>

      <ion-card class="console-card">
        <ion-card-header>
          <ion-card-title>Records</ion-card-title>
          <p class="section-copy">Hotels currently available for staff, rooms, and request routing.</p>
        </ion-card-header>
        <ion-card-content>
          @if (loading()) {
            <p class="empty-text">Loading...</p>
          } @else {
            <div class="console-list">
              @for (item of items(); track item.id ?? item.name) {
                <article class="console-record">
                  <h3>{{ item.name }}</h3>
                  <p>{{ item.city || '-' }}, {{ item.country || '-' }}</p>
                  <div class="record-metadata">
                    <span class="console-pill">Code: {{ item.code || '-' }}</span>
                    <span class="console-pill">
                      Group: {{ item.hotelGroup?.name || ('#' + (item.hotelGroup?.id ?? '?')) }}
                    </span>
                  </div>
                  <div class="inline-actions">
                    <ion-button type="button" fill="outline" class="inline-neutral" size="small" (click)="edit(item)">
                      Edit
                    </ion-button>
                    <ion-button type="button" fill="outline" class="inline-danger" size="small" (click)="remove(item)">
                      Delete
                    </ion-button>
                  </div>
                </article>
              } @empty {
                <p class="empty-text">No hotels found.</p>
              }
            </div>
          }
        </ion-card-content>
      </ion-card>
    </div>
  </div>
</ion-content>
